<extend name="Public:base" />
<!-- 需要继承的不用写，不需要继承（去掉的）要写，并且里面为空 -->
<block name="style-header">
 <link href="__STYLE__/css/bootstrap.min.css" rel="stylesheet" media="screen">
    <link href="__STYLE__/css/bootstrap-datetimepicker.min.css" rel="stylesheet" media="screen">

<link href='http://fonts.googleapis.com/css?family=Open+Sans:400,700' rel='stylesheet' type='text/css'>
        <link rel="stylesheet" type="text/css" href="__CSS__/bootstrap.css">
        <link rel="stylesheet" href="__CSS__/font-awesome.css">
		 <link rel="stylesheet" type="text/css" href="__CSS__/theme.css">
        <link rel="stylesheet" type="text/css" href="__CSS__/premium.css">
		<style>
			form {
				margin: 0;
			}
			textarea {
				display: block;
			}
		</style>
		<link rel="stylesheet" href="http://182.92.11.136/car/Public/kindeditor/themes/default/default.css" />
		<script charset="utf-8" src="http://182.92.11.136/car/Public/kindeditor/kindeditor.js"></script>
		<script charset="utf-8" src="http://182.92.11.136/car/Public/kindeditor/lang/zh_CN.js"></script>
		<script>
			KindEditor.ready(function(K) {
				K.create('textarea[name="xiangqing"]', {
					autoHeightMode : true,
					afterCreate : function() {
						this.loadPlugin('autoheight');
					}
				});
			});
		</script>

</block>
<block name="main-header">
	<div class="header">
        <h1 class="page-title">报价管理</h1>
        <ul class="breadcrumb">
            <li>报价管理</li>
            <li class="active">报价管理</li>
        </ul>
    </div>
</block>
<block name="main-content">
<script src="__JS__/chosen.jquery.js" type="text/javascript"></script>
<link rel="stylesheet" type="text/css" href="__CSS__/chosen.css">
	<div class="main-content" style="height: 2340px;">
		<form enctype="multipart/form-data" onsubmit="return checkForm()" action="{:U('price_add_update')}" method="post" >
			<div class="form-group">
				<label class="col-md-12 control-label" style="padding:0px 0px 5px 0px;">厂商</label>
				<div class="col-md-6" style="padding:0px 0px 10px 0px;">
				<select class="chzn-select form-control" name='factory_id' id='factory'>
				<option>请选择</option>
					<volist name='factory' id='vo'>
					 <option value='{$vo['id']}'>{$vo['factory_name_ch']}</option>
					</volist>
				</select>
			</div>
	</div>
			<div class="form-group">
				<label class="col-md-12 control-label" style="padding:0px 0px 5px 0px;">车型</label>
				<div class="col-md-6" style="padding:0px 0px 10px 0px;">
				<select class="chzn-select form-control" name='chexing_id' id="chexing">
					  <option>请选择</option>
				</select>
				</div>
			</div>

			<div class="form-group">
				<label class="col-md-12 control-label" style="padding:0px 0px 5px 0px;">年款</label>
				<div class="col-md-6" style="padding:0px 0px 10px 0px;">
				<select class="chzn-select form-control" name='year_id'>
					<volist name='year' id='vo'>
					  <option value='{$vo['id']}'>{$vo['year_name_ch']}</option>
					</volist>
				</select>
				</div>
			</div>	

			<div class="form-group">
				<label class="col-md-12 control-label" style="padding:0px 0px 5px 0px;">规格名称</label>
				<div class="col-md-6" style="padding:0px 0px 10px 0px;">
				<select class="chzn-select form-control" name='guige_id' id="guige">
					  <option value='0'>请选择</option>
				</select>
				</div>
			</div>

			<div class="form-group">
				<label class="col-md-12 control-label" style="padding:0px 0px 5px 0px;">信息来源</label>
				<div class="col-md-6" style="padding:0px 0px 10px 0px;">
				<select class="chzn-select form-control" name='company_id'>
					<volist name='company' id='vo'>
					  <option value='{$vo['id']}'>{$vo['company_name_ch']}</option>
					</volist>
				</select>
				</div>
			</div>
			<div class="form-group">
				<label class="col-md-12 control-label" style="padding:0px 0px 5px 0px;">车辆台数: <span style="color:red">*</span></label>
				<div class="col-md-6" style="padding:0px 0px 10px 0px;">
					<input type="text" class="form-control" name="sum" id="sum" placeholder="必填项,请输入数字" value="">
				</div>
			</div>
			<div class="form-group">
				<label class="col-md-12 control-label" style="padding:0px 0px 5px 0px;">货物批号: <span style="color:red">*</span></label>
				<div class="col-md-6" style="padding:0px 0px 10px 0px;">
					<input type="text" class="form-control" name="pihao" id="pihao" placeholder="必填项" value="">
				</div>
			</div>
			<div class="form-group">
				<label class="col-md-12 control-label" style="padding:0px 0px 5px 0px;">是否特价车: </label>
				<div class="col-md-6" style="padding:0px 0px 10px 0px;">
					<label class="radio-inline">
						<input type="radio" name="tejia" id="tejia" value="1"> 是
					</label>
					<label class="radio-inline">
						<input type="radio" name="tejia" id="tejia" value="0" checked="checked"> 否
					</label>
				</div>
		   	</div>
		   	<div class="form-group">
				<label class="col-md-12 control-label" style="padding:0px 0px 5px 0px;">是否新车上架: </label>
				<div class="col-md-6" style="padding:0px 0px 10px 0px;">
					<label class="radio-inline">
						<input type="radio" name="newcar" id="newcar" value="1"> 是
					</label>
					<label class="radio-inline">
						<input type="radio" name="newcar" id="newcar" value="0" checked="checked"> 否
					</label>
				</div>
		   	</div>
			<div class="form-group">
                <label for="dtp_input2" class="col-md-12 control-label" style="padding:0px 0px 5px 0px;">预计到港时间: </label><br/><br/><br/><br/><br/><br/><br/><br/><br/><br/><br/><br/><br/><br/><br/><br/><br/><br/><br/><br/><br/><br/><br/><br/><br/><br/>
                <div class="input-group date form_date col-md-6" data-date="" data-date-format="yyyy-mm-dd" data-link-field="dtp_input2" data-link-format="yyyy-mm-dd">
                    <input class="form-control" size="16" type="text" value="" readonly name="dtime">
                    <span class="input-group-addon"><span class="glyphicon glyphicon-remove"></span></span>
					<span class="input-group-addon"><span class="glyphicon glyphicon-calendar"></span></span>
                </div>
				<input type="hidden" id="dtime" value="" /><br/>
            </div>
			<div class="form-group">
				<label class="col-md-12 control-label" style="padding:0px 0px 5px 0px;">主要参数: <span style="color:red">*</span></label>
				<div class="col-md-6" style="padding:0px 0px 10px 0px;">
					<textarea type="text" class="form-control" name="canshu" id="canshu" placeholder="" value=""></textarea>
				</div>
			</div>　<span style="color:red">*标准格式:　长*宽*高:4000X2000X1000 换行请回车</span>
			<div class="form-group">
				<label class="col-md-12 control-label" style="padding:0px 0px 5px 0px;">主要配置: <span style="color:red">*</span></label>
				<div class="col-md-6" style="padding:0px 0px 10px 0px;">
					<textarea type="text" class="form-control" name="peizhi" id="peizhi" placeholder="必填项" value=""></textarea>
				</div>
			</div>
			<div class="form-group">
				<label class="col-md-12 control-label" style="padding:0px 0px 5px 0px;">颜色: <span style="color:red">*</span></label>
				<div class="col-md-6" style="padding:0px 0px 10px 0px;">
					<input type="text" class="form-control" name="color" id="color" placeholder="必填项" value="">
				</div>
			</div>
			<div class="form-group">
				<label class="col-md-12 control-label" style="padding:0px 0px 5px 0px;">网址: </label>
				<div class="col-md-6" style="padding:0px 0px 10px 0px;">
					<input type="text" class="form-control" name="wangzhi" id="wangzhi" placeholder="" value="">
				</div>
			</div>
			<div class="form-group">
				<label class="col-md-12 control-label" style="padding:0px 0px 5px 0px;">是否显示: <span style="color:red">*</span></label>
				<div class="col-md-6" style="padding:0px 0px 10px 0px;">
					<label class="radio-inline">
						<input type="radio" name="price_display" id="price_display" value="1" checked="checked"> 显示
					</label>
					<label class="radio-inline">
						<input type="radio" name="price_display" id="price_display" value="0"> 不显示
					</label>
				</div>
		   </div>

		   <div class="row">
					<div class="col-md-7" style="width:600px;">
					<table class="table table-bordered">
						<thead>
							<tr>
								<th>报价类型名称</th>
								<th>报价</th>
								<th>单位</th>
								<th>货币种类</th>
							</tr>
						</thead>
						<tbody>
							<volist name='pritype' id='vo'>
							<tr>
								<td><input type="hidden" class="form-control" name="typename[]" id="typename" placeholder="" value="{$vo['id']}">{$vo['pritype_name']}</td>
								<td><input type="text" class="form-control" name="baojia[]" id="baojia" placeholder="" value=""></td>
								<td>万</td>
								<td><select class="form-control" name='huobi[]' id='huobi[]'>
									  <option value="人民币">人民币</option>
									  <option value="美元">美元</option>
									  <option value="欧元">欧元</option>
									  </select>
								</td>
							</tr>
							</volist>
						</tbody>
					</table>
					</div>
			</div>
		   <!--
		   <div class="form-group">
				<label class="col-md-12 control-label" style="padding:0px 0px 5px 0px;">　报价名称</label>
			</div>
			<div class="form-group">
				<label class="col-md-12 control-label" style="padding: 0px 0px 5px; width: 152px; margin-top: 6px;">　期货价: <span style="color:red">*</span></label>
			</div>
			<div class="form-group">
				<label class="col-md-12 control-label" style="padding:0px 0px 5px 0px;"></label>
			</div>
			<div class="form-group">
				<label class="col-md-12 control-label" style="padding:0px 0px 5px 0px;">　离岗价: <span style="color:red">*</span></label>
			</div>
			<div class="form-group">
				<label class="col-md-12 control-label" style="padding:0px 0px 5px 0px;"></label>
			</div>
			<div class="form-group">
				<label class="col-md-12 control-label" style="padding:0px 0px 5px 0px;">　在途价: <span style="color:red">*</span></label>
			</div>
			<div class="form-group">
				<label class="col-md-12 control-label" style="padding:0px 0px 5px 0px;"></label>
			</div>
			<div class="form-group">
				<label class="col-md-12 control-label" style="padding:0px 0px 5px 0px;">　到港价: <span style="color:red">*</span></label>
			</div>

			<div class="form-group">
				<label class="col-md-12 control-label" style="margin-top:-190px;margin-left:180px;margin-bottom:-30px;">　报价</label>
				<div class="col-md-2" style="margin-top:-160px;margin-left:160px;margin-bottom:-30px;">
					<input type="text" class="form-control" name="pricedao" id="pricedao" placeholder="必填项" value="">
				</div>
				<div class="col-md-2" style="margin-top:-120px;margin-left:160px;margin-bottom:-30px;">
					<input type="text" class="form-control" name="priceli" id="priceli" placeholder="必填项" value="">
				</div>
				<div class="col-md-2" style="margin-top:-80px;margin-left:160px;margin-bottom:-30px;">
					<input type="text" class="form-control" name="pricezai" id="pricezai" placeholder="必填项" value="">
				</div>
				<div class="col-md-2" style="margin-top:-40px;margin-left:160px;margin-bottom:-30px;">
					<input type="text" class="form-control" name="priceqi" id="priceqi" placeholder="必填项" value="">
				</div>
			</div>
			-->

			<div class="form-group">
				<label class="col-md-12 control-label" style="padding:0px 0px 5px 0px;">当前有效报价：</label>
				<div class="col-md-6" style="padding: 0px 0px 10px 0px;">　
					<select class="form-control" name='nowprice'>
						<volist name='pritype' id='vo'>
						  <option value='{$vo['id']}'>{$vo['pritype_name']}</option>
						</volist>
					</select>
				</div>
			</div>	
			<br><br><br><br>

			<div class="control-group">
				<label for="insertimage"class="col-md-12 control-label" style="padding:0px 0px 5px 0px;">上传车图: <span style="color:red">*车图大小:350*200</span></label>
				<div class="col-md-2" style="padding:0px 0px 10px 0px;">
					<div class="controls">
						<a id="preview">
						    <img id='imghead1' src="http://101.201.148.160/car/Public/upload/img/test.jpg" style="max-width:143px;height:auto;">
						</a>
						<input id="picurl" name="picurl" class="input-medium" type="file" onChange="previewImage(this)"  style="margin-bottom:10px;width: 65px;">
					</div>
				</div>
				<div class="col-md-2" style="padding:0px 0px 10px 0px;">
					<div class="controls">
						<a id="preview1">
						    <img id='imghead2' src="http://101.201.148.160/car/Public/upload/img/test.jpg" style="max-width:143px;height:auto;">
						</a>
						<input id="pic" name="pic" class="input-medium" type="file" onChange="previewImage1(this)"  style="margin-bottom:10px;width: 65px;">
					</div>
				</div>
				<div class="col-md-2" style="padding:0px 0px 10px 0px;">
					<div class="controls">
						<a id="preview2">
						   <img id='imghead3' src="http://101.201.148.160/car/Public/upload/img/test.jpg" style="max-width:143px;height:auto;"> 
						</a>
						<input id="picc" name="picc" class="input-medium" type="file" onChange="previewImage2(this)"  style="margin-bottom:10px;width: 65px;">
					</div>
				</div>
				<div class="col-md-2" style="padding:0px 0px 10px 0px;">
					<div class="controls">
						<a id="preview3">
						    <img id='imghead4' src="http://101.201.148.160/car/Public/upload/img/test.jpg" style="max-width:143px;height:auto;">
						</a>
						<input id="piccc" name="piccc" class="input-medium" type="file" onChange="previewImage3(this)"  style="margin-bottom:10px;width: 65px;">
					</div>
				</div>
				<div class="col-md-2" style="padding:0px 0px 10px 0px;">
					<div class="controls">
						<a id="preview4">
						    <img id='imghead5' src="http://101.201.148.160/car/Public/upload/img/test.jpg" style="max-width:143px;height:auto;">
						</a>
						<input id="picccc" name="picccc" class="input-medium" type="file" onChange="previewImage4(this)"  style="margin-bottom:10px;width: 65px;">
					</div>
				</div>
			</div>


			<div id="dialog-form" title="从图库中选择" style="display:none" >
			
</div><br/><br/><br/>
<input name="bc" id="bc" type = "hidden" value="">





			<div class="form-group">
				<label class="col-md-12 control-label" style="padding:0px 0px 5px 0px;"></label>
				<div class="col-md-6" style="padding:0px 0px 10px 0px;">
					<input type="button" id="create-user" onclick="tutu();" value="从图库中选择">
				</div>
			</div>
			<div class="form-group">
				<label class="col-md-12 control-label" style="padding:0px 0px 5px 0px;">价格1: </label>
				<div class="col-md-6" style="padding:0px 0px 10px 0px;">
					<input type="text" class="form-control" name="tianone" id="tianone" placeholder="" value="">
				</div>
			</div>
			<div class="form-group">
				<label class="col-md-12 control-label" style="padding:0px 0px 5px 0px;">价格: </label>
				<div class="col-md-6" style="padding:0px 0px 10px 0px;">
					<input type="text" class="form-control" name="jiaone" id="jiaone" placeholder="" value="">
				　
					<select class="form-control" name='huobi1' id='huobi1'>
						<option value="人民币">人民币</option>
						<option value="美元">美元</option>
						<option value="欧元">欧元</option>
					</select>
				</div>
			</div>	
			<div class="form-group">
				<label class="col-md-12 control-label" style="padding:0px 0px 5px 0px;">价格2: </label>
				<div class="col-md-6" style="padding:0px 0px 10px 0px;">
					<input type="text" class="form-control" name="tiantwo" id="tiantwo" placeholder="" value="">
				</div>
			</div>
			<div class="form-group">
				<label class="col-md-12 control-label" style="padding:0px 0px 5px 0px;">价格: </label>
				<div class="col-md-6" style="padding:0px 0px 10px 0px;">
					<input type="text" class="form-control" name="jiatwo" id="jiatwo" placeholder="" value="">
				　
					<select class="form-control" name='huobi2' id='huobi2'>
						<option value="人民币">人民币</option>
						<option value="美元">美元</option>
						<option value="欧元">欧元</option>
					</select>
				</div>
			</div>
			<div class="form-group">
				<label class="col-md-12 control-label" style="padding:0px 0px 5px 0px;">详情: &nbsp&nbsp</label>
				<div class="col-md-6" style="padding:0px 0px 10px 0px;">
					<textarea name="xiangqing" style="width:600px;height:200px;"></textarea>
				</div>
		   </div>


			<div class="form-group">
					<div class="btn-toolbar list-toolbar col-md-offset-2 col-md-10" style="margin-top:15px;margin-bottom:40px;">
				    <button type="submit" class="btn btn-primary"><i class="fa fa-save"></i> 保 存</button>
					<a href="{:U('price_list')}" class="btn btn-danger" style="margin-left: 60px;"><i class="glyphicon glyphicon-list"></i> 返回列表</a>
			</div>
		</form>
	</div>

	
<link rel="stylesheet" href="http://apps.bdimg.com/libs/jqueryui/1.10.4/css/jquery-ui.min.css">
<script type="text/javascript" src="__JS__/jquery-1.11.1.min.js" charset="UTF-8"></script>
<!-- <script src="http://apps.bdimg.com/libs/jquery/1.10.2/jquery.min.js"></script> -->
<script src="http://apps.bdimg.com/libs/jqueryui/1.10.4/jquery-ui.min.js"></script>
<!-- <script type="text/javascript" src="__JS__/jquery-1.11.1.min.js" charset="UTF-8"></script> -->
<script type="text/javascript" src="__STYLE__/js/bootstrap.min.js"></script>
<script type="text/javascript" src="__STYLE__/js/bootstrap-datetimepicker.js" charset="UTF-8"></script>
<script type="text/javascript" src="__STYLE__/js/locales/bootstrap-datetimepicker.fr.js" charset="UTF-8"></script>
<script type="text/javascript" src="__STYLE__/js/bootstrap-datetimepicker.zh-CN.js"></script>
<script type="text/javascript">
$('#factory').on('change', function() {
			$.ajax({
				type: "POST",
		        url: "{:U('chexing_select')}",
		        dataType: "json",
		        data: "factory_id="+$('#factory').val(),
		        success: function(msg){
		        	html_chexing = "<option value=''>请选择</option>";
		            $(msg).each(function(){ //遍历json数组
				        html_chexing += "<option value=\""+this.id+"\">"+this.chexing_name_ch+"</option>";
			        }); 
			        $("#chexing").empty();
		            $("#chexing").append(html_chexing);
   
		        }
		    });
		    
		    $.ajax({
				type: "POST",
		        url: "{:U('pic_select')}",
		        dataType: "json",
		        data: "factory_id="+$('#factory').val(),
		        success: function(msg){
		        	 document.getElementById('dialog-form').innerHTML= msg;
		        	// document.getElementById("test").value=msg;
		        	 //alert(msg);
		        	// window.location.reload();
		        }
		    });
		});

$('#chexing').on('change', function() {
			$.ajax({
				type: "POST",
		        url: "{:U('guige_select')}",
		        dataType: "json",
		        data: "chexing_id="+$('#chexing').val(),
		        success: function(msg){
		        	html_guige = "<option value=''>请选择</option>";
		            $(msg).each(function(){ //遍历json数组
				        html_guige += "<option value=\""+this.id+"\">"+this.guige_name_ch+"</option>";
			        }); 
			        $("#guige").empty();
		            $("#guige").append(html_guige);
   
		        }
		    });
		});
	$('.form_date').datetimepicker({
        language:  'fr',
        weekStart: 1,
        todayBtn:  1,
		autoclose: 1,
		todayHighlight: 1,
		startView: 2,
		minView: 2,
		forceParse: 0,
		language:'zh-CN',
    });
$(document).ready(function() {
	$( "#dialog-form" ).dialog({
      autoOpen: false,
      height: 400,
      width: 550,
      modal: true,
      buttons: {
        "OK": function() {
        	
          //alert("hello");
         	// var b=document.getElementsByName("abc").value;
         	// alert(b.length);
        var obj = document.getElementsByName("abc");//选择所有name="interest"的对象，返回数组      
            var s='';//如果这样定义var s;变量s中会默认被赋个null值  
            for(var i=0;i<obj.length;i++){  
                 if(obj[i].checked) //取到对象数组后，我们来循环检测它是不是被选中  
                 s+=obj[i].value+',';   //如果选中，将value添加到变量s中      
            } 

        document.getElementById("bc").value = s;
       
		$( this ).dialog( "close" );
		          
		        },
		        Cancel: function() {
		          //alert("hello");
		          $( this ).dialog( "close" );
		        }
		      },
		      close: function() {
		       // alert("hello");
		      }
    });
			// 先赋值，再初始化
			$(".chzn-select").chosen();

	
		});
	function tutu(){
		  	//alert("test");
		  	 $("#dialog-form").dialog("open");
		  	}
		</script>
		<script type="text/javascript">
		function checkForm(){
					var a=document.getElementById("factory").value;
				   if ((a == null) || (a.length == 0) || (a == 0) || (a == "") || (a == "请选择"))
				   {
					   alert("请选择厂商！");
					   return false;
				   }

					var c=document.getElementById("chexing").value;
				   if ((c == null) || (c.length == 0) || (c == 0) || (c == "") || (c == "请选择"))
				   {
					   alert("请选择车型！");
					   return false;
				   }

					var b=document.getElementById("guige").value;
				   if ((b == null) || (b.length == 0) || (b == 0) || (b == "") || (b == "请选择"))
				   {
					   alert("请选择规格！");
					   return false;
				   }

			       var x=document.getElementById("sum").value;
				   if ((x == null) || (x.length == 0))
				   {
					   alert("车辆台数不能为空！");
					   return false;
				   }

				   var y=document.getElementById("pihao").value;
				   if ((y == null) || (y.length == 0))
				   {
					   alert("批号不能为空！");
					   return false;
				   }

				   var z=document.getElementById("canshu").value;
				   if ((z == null) || (z.length == 0))
				   {
					   alert("主要参数不能为空！");
					   return false;
				   }

				   var l=document.getElementById("peizhi").value;
				   if ((l == null) || (l.length == 0))
				   {
					   alert("主要配置不能为空！");
					   return false;
				   }

				   var m=document.getElementById("color").value;
				   if ((m == null) || (m.length == 0))
				   {
					   alert("颜色不能为空！");
					   return false;
				   }
          }
			$('#sum').on('blur', function() {
				$.ajax({
					type: "POST",
			        url: "{:U('price_check')}",
			        contentType:"application/x-www-form-urlencoded;charset=utf-8", 
			        dataType: "json",
			        data: {sum:$('#sum').val()},
			        success: function(msg){
        				alert(msg.info);        	  
			        }
			    });
			});
			$('#pihao').on('blur', function() {
				$.ajax({
					type: "POST",
			        url: "{:U('price_check')}",
			        contentType:"application/x-www-form-urlencoded;charset=utf-8", 
			        dataType: "json",
			        data: {pihao:$('#pihao').val()},
			        success: function(msg){
        				alert(msg.info);        	  
			        }
			    });
			});
			$('#canshu').on('blur', function() {
				$.ajax({
					type: "POST",
			        url: "{:U('price_check')}",
			        contentType:"application/x-www-form-urlencoded;charset=utf-8", 
			        dataType: "json",
			        data: {canshu:$('#canshu').val()},
			        success: function(msg){
        				alert(msg.info);        	  
			        }
			    });
			});
			$('#peizhi').on('blur', function() {
				$.ajax({
					type: "POST",
			        url: "{:U('price_check')}",
			        contentType:"application/x-www-form-urlencoded;charset=utf-8", 
			        dataType: "json",
			        data: {peizhi:$('#peizhi').val()},
			        success: function(msg){
        				alert(msg.info);        	  
			        }
			    });
			});
			$('#color').on('blur', function() {
				$.ajax({
					type: "POST",
			        url: "{:U('price_check')}",
			        contentType:"application/x-www-form-urlencoded;charset=utf-8", 
			        dataType: "json",
			        data: {color:$('#color').val()},
			        success: function(msg){
        				alert(msg.info);        	  
			        }
			    });
			});
			$('#wangzhi').on('blur', function() {
				$.ajax({
					type: "POST",
			        url: "{:U('price_check')}",
			        contentType:"application/x-www-form-urlencoded;charset=utf-8", 
			        dataType: "json",
			        data: {wangzhi:$('#wangzhi').val()},
			        success: function(msg){
        				alert(msg.info);        	  
			        }
			    });
			});
		</script>
		<script>
		//图片上传
		function previewImage(file)
		{
		var MAXWIDTH  = 260;
		var MAXHEIGHT = 100;
		var div = document.getElementById('preview');
		if (file.files && file.files[0])
		{
		div.innerHTML ='<img id=imghead1>';
		var img = document.getElementById('imghead1');
		img.onload = function(){
		var rect = clacImgZoomParam(MAXWIDTH, MAXHEIGHT, img.offsetWidth, img.offsetHeight);
		img.width  =  rect.width;
		img.height =  rect.height;
		//                 img.style.marginLeft = rect.left+'px';
		img.style.marginTop = rect.top+'px';
		}
		var reader = new FileReader();
		reader.onload = function(evt){img.src = evt.target.result;}
		reader.readAsDataURL(file.files[0]);
		}
		else //兼容IE
		{
		var sFilter='filter:progid:DXImageTransform.Microsoft.AlphaImageLoader(sizingMethod=scale,src="';
		file.select();
		var src = document.selection.createRange().text;
		div.innerHTML = '<img id=imghead1>';
		var img = document.getElementById('imghead1');
		img.filters.item('DXImageTransform.Microsoft.AlphaImageLoader').src = src;
		var rect = clacImgZoomParam(MAXWIDTH, MAXHEIGHT, img.offsetWidth, img.offsetHeight);
		status =('rect:'+rect.top+','+rect.left+','+rect.width+','+rect.height);
		div.innerHTML = "<div id=divhead style='width:"+rect.width+"px;height:"+rect.height+"px;margin-top:"+rect.top+"px;"+sFilter+src+"\"'></div>";
		}
		}
		function clacImgZoomParam( maxWidth, maxHeight, width, height ){
		var param = {top:0, left:0, width:width, height:height};
		if( width>maxWidth || height>maxHeight )
		{
		rateWidth = width / maxWidth;
		rateHeight = height / maxHeight;
		
		if( rateWidth > rateHeight )
		{
		param.width =  maxWidth;
		param.height = Math.round(height / rateWidth);
		}else
		{
		param.width = Math.round(width / rateHeight);
		param.height = maxHeight;
		}
		}
		
		param.left = Math.round((maxWidth - param.width) / 2);
		param.top = Math.round((maxHeight - param.height) / 2);
		return param;
		}
				window.document.onkeydown = function(e) {
					if ('' == document.activeElement.id) {
						var e=e || event;
						var currKey=e.keyCode || e.which || e.charCode;
						if (8 == currKey) {
							return false;
						}
					}
				};
		</script>
		<script>
		//图片上传
		function previewImage1(file)
		{
		var MAXWIDTH  = 260;
		var MAXHEIGHT = 100;
		var div = document.getElementById('preview1');
		if (file.files && file.files[0])
		{
		div.innerHTML ='<img id=imghead2>';
		var img = document.getElementById('imghead2');
		img.onload = function(){
		var rect = clacImgZoomParam(MAXWIDTH, MAXHEIGHT, img.offsetWidth, img.offsetHeight);
		img.width  =  rect.width;
		img.height =  rect.height;
		//                 img.style.marginLeft = rect.left+'px';
		img.style.marginTop = rect.top+'px';
		}
		var reader = new FileReader();
		reader.onload = function(evt){img.src = evt.target.result;}
		reader.readAsDataURL(file.files[0]);
		}
		else //兼容IE
		{
		var sFilter='filter:progid:DXImageTransform.Microsoft.AlphaImageLoader(sizingMethod=scale,src="';
		file.select();
		var src = document.selection.createRange().text;
		div.innerHTML = '<img id=imghead2>';
		var img = document.getElementById('imghead2');
		img.filters.item('DXImageTransform.Microsoft.AlphaImageLoader').src = src;
		var rect = clacImgZoomParam(MAXWIDTH, MAXHEIGHT, img.offsetWidth, img.offsetHeight);
		status =('rect:'+rect.top+','+rect.left+','+rect.width+','+rect.height);
		div.innerHTML = "<div id=divhead style='width:"+rect.width+"px;height:"+rect.height+"px;margin-top:"+rect.top+"px;"+sFilter+src+"\"'></div>";
		}
		}
		function clacImgZoomParam( maxWidth, maxHeight, width, height ){
		var param = {top:0, left:0, width:width, height:height};
		if( width>maxWidth || height>maxHeight )
		{
		rateWidth = width / maxWidth;
		rateHeight = height / maxHeight;
		
		if( rateWidth > rateHeight )
		{
		param.width =  maxWidth;
		param.height = Math.round(height / rateWidth);
		}else
		{
		param.width = Math.round(width / rateHeight);
		param.height = maxHeight;
		}
		}
		
		param.left = Math.round((maxWidth - param.width) / 2);
		param.top = Math.round((maxHeight - param.height) / 2);
		return param;
		}
				window.document.onkeydown = function(e) {
					if ('' == document.activeElement.id) {
						var e=e || event;
						var currKey=e.keyCode || e.which || e.charCode;
						if (8 == currKey) {
							return false;
						}
					}
				};
		</script>
		<script>
		//图片上传
		function previewImage2(file)
		{
		var MAXWIDTH  = 260;
		var MAXHEIGHT = 100;
		var div = document.getElementById('preview2');
		if (file.files && file.files[0])
		{
		div.innerHTML ='<img id=imghead3>';
		var img = document.getElementById('imghead3');
		img.onload = function(){
		var rect = clacImgZoomParam(MAXWIDTH, MAXHEIGHT, img.offsetWidth, img.offsetHeight);
		img.width  =  rect.width;
		img.height =  rect.height;
		//                 img.style.marginLeft = rect.left+'px';
		img.style.marginTop = rect.top+'px';
		}
		var reader = new FileReader();
		reader.onload = function(evt){img.src = evt.target.result;}
		reader.readAsDataURL(file.files[0]);
		}
		else //兼容IE
		{
		var sFilter='filter:progid:DXImageTransform.Microsoft.AlphaImageLoader(sizingMethod=scale,src="';
		file.select();
		var src = document.selection.createRange().text;
		div.innerHTML = '<img id=imghead3>';
		var img = document.getElementById('imghead3');
		img.filters.item('DXImageTransform.Microsoft.AlphaImageLoader').src = src;
		var rect = clacImgZoomParam(MAXWIDTH, MAXHEIGHT, img.offsetWidth, img.offsetHeight);
		status =('rect:'+rect.top+','+rect.left+','+rect.width+','+rect.height);
		div.innerHTML = "<div id=divhead style='width:"+rect.width+"px;height:"+rect.height+"px;margin-top:"+rect.top+"px;"+sFilter+src+"\"'></div>";
		}
		}
		function clacImgZoomParam( maxWidth, maxHeight, width, height ){
		var param = {top:0, left:0, width:width, height:height};
		if( width>maxWidth || height>maxHeight )
		{
		rateWidth = width / maxWidth;
		rateHeight = height / maxHeight;
		
		if( rateWidth > rateHeight )
		{
		param.width =  maxWidth;
		param.height = Math.round(height / rateWidth);
		}else
		{
		param.width = Math.round(width / rateHeight);
		param.height = maxHeight;
		}
		}
		
		param.left = Math.round((maxWidth - param.width) / 2);
		param.top = Math.round((maxHeight - param.height) / 2);
		return param;
		}
				window.document.onkeydown = function(e) {
					if ('' == document.activeElement.id) {
						var e=e || event;
						var currKey=e.keyCode || e.which || e.charCode;
						if (8 == currKey) {
							return false;
						}
					}
				};
		</script>
		<script>
		//图片上传
		function previewImage3(file)
		{
		var MAXWIDTH  = 260;
		var MAXHEIGHT = 100;
		var div = document.getElementById('preview3');
		if (file.files && file.files[0])
		{
		div.innerHTML ='<img id=imghead4>';
		var img = document.getElementById('imghead4');
		img.onload = function(){
		var rect = clacImgZoomParam(MAXWIDTH, MAXHEIGHT, img.offsetWidth, img.offsetHeight);
		img.width  =  rect.width;
		img.height =  rect.height;
		//                 img.style.marginLeft = rect.left+'px';
		img.style.marginTop = rect.top+'px';
		}
		var reader = new FileReader();
		reader.onload = function(evt){img.src = evt.target.result;}
		reader.readAsDataURL(file.files[0]);
		}
		else //兼容IE
		{
		var sFilter='filter:progid:DXImageTransform.Microsoft.AlphaImageLoader(sizingMethod=scale,src="';
		file.select();
		var src = document.selection.createRange().text;
		div.innerHTML = '<img id=imghead4>';
		var img = document.getElementById('imghead4');
		img.filters.item('DXImageTransform.Microsoft.AlphaImageLoader').src = src;
		var rect = clacImgZoomParam(MAXWIDTH, MAXHEIGHT, img.offsetWidth, img.offsetHeight);
		status =('rect:'+rect.top+','+rect.left+','+rect.width+','+rect.height);
		div.innerHTML = "<div id=divhead style='width:"+rect.width+"px;height:"+rect.height+"px;margin-top:"+rect.top+"px;"+sFilter+src+"\"'></div>";
		}
		}
		function clacImgZoomParam( maxWidth, maxHeight, width, height ){
		var param = {top:0, left:0, width:width, height:height};
		if( width>maxWidth || height>maxHeight )
		{
		rateWidth = width / maxWidth;
		rateHeight = height / maxHeight;
		
		if( rateWidth > rateHeight )
		{
		param.width =  maxWidth;
		param.height = Math.round(height / rateWidth);
		}else
		{
		param.width = Math.round(width / rateHeight);
		param.height = maxHeight;
		}
		}
		
		param.left = Math.round((maxWidth - param.width) / 2);
		param.top = Math.round((maxHeight - param.height) / 2);
		return param;
		}
				window.document.onkeydown = function(e) {
					if ('' == document.activeElement.id) {
						var e=e || event;
						var currKey=e.keyCode || e.which || e.charCode;
						if (8 == currKey) {
							return false;
						}
					}
				};
		</script>
		<script>
		//图片上传
		function previewImage4(file)
		{
		var MAXWIDTH  = 260;
		var MAXHEIGHT = 100;
		var div = document.getElementById('preview4');
		if (file.files && file.files[0])
		{
		div.innerHTML ='<img id=imghead5>';
		var img = document.getElementById('imghead5');
		img.onload = function(){
		var rect = clacImgZoomParam(MAXWIDTH, MAXHEIGHT, img.offsetWidth, img.offsetHeight);
		img.width  =  rect.width;
		img.height =  rect.height;
		//                 img.style.marginLeft = rect.left+'px';
		img.style.marginTop = rect.top+'px';
		}
		var reader = new FileReader();
		reader.onload = function(evt){img.src = evt.target.result;}
		reader.readAsDataURL(file.files[0]);
		}
		else //兼容IE
		{
		var sFilter='filter:progid:DXImageTransform.Microsoft.AlphaImageLoader(sizingMethod=scale,src="';
		file.select();
		var src = document.selection.createRange().text;
		div.innerHTML = '<img id=imghead5>';
		var img = document.getElementById('imghead5');
		img.filters.item('DXImageTransform.Microsoft.AlphaImageLoader').src = src;
		var rect = clacImgZoomParam(MAXWIDTH, MAXHEIGHT, img.offsetWidth, img.offsetHeight);
		status =('rect:'+rect.top+','+rect.left+','+rect.width+','+rect.height);
		div.innerHTML = "<div id=divhead style='width:"+rect.width+"px;height:"+rect.height+"px;margin-top:"+rect.top+"px;"+sFilter+src+"\"'></div>";
		}
		}
		function clacImgZoomParam( maxWidth, maxHeight, width, height ){
		var param = {top:0, left:0, width:width, height:height};
		if( width>maxWidth || height>maxHeight )
		{
		rateWidth = width / maxWidth;
		rateHeight = height / maxHeight;
		
		if( rateWidth > rateHeight )
		{
		param.width =  maxWidth;
		param.height = Math.round(height / rateWidth);
		}else
		{
		param.width = Math.round(width / rateHeight);
		param.height = maxHeight;
		}
		}
		
		param.left = Math.round((maxWidth - param.width) / 2);
		param.top = Math.round((maxHeight - param.height) / 2);
		return param;
		}
				window.document.onkeydown = function(e) {
					if ('' == document.activeElement.id) {
						var e=e || event;
						var currKey=e.keyCode || e.which || e.charCode;
						if (8 == currKey) {
							return false;
						}
					}
				};
		</script>
		<script> var a=document.getElementById('factory'); </script>
</block>
